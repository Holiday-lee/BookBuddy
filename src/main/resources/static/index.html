<!DOCTYPE html>
<!--
Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
Click nbfs://nbhost/SystemFileSystem/Templates/Other/html.html to edit this template
-->

<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="Read It. Swap It. Love It.">
        <meta name="keywords" content="book exchange, book swap, book swap app, book swap platforms">
        <meta name="robots" content="index,follow">
        <meta name="googlebot" content="index,follow">

        <!-- Page Title & Favicon -->
        <title>BookBuddy - Your Neighborhood Book Exchange Platform</title>	
        <link rel="icon" href="/images/bookbuddy_logo.png" type="image/png">

        <!-- Add bootstrap -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

        <!-- Add CSS sheet -->
        <link rel="stylesheet" href="/css/stylesheet.css">
        <link rel="stylesheet" href="/css/index.css">
    </head>

    <body>
    <!-- Simplified Dynamic Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top">
        <div class="container-fluid ms-3">
            <a class="navbar-brand" href="/">						
                <img src="/images/bookbuddy_logo.png" alt="Logo" height="80">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMenu">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navMenu">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    
                    <!-- Homepage always visible for public -->
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="/">Home</a>
                    </li>
                    
                    <!-- Search a Books always visible for public -->
                    <li class="nav-item">
                        <a class="nav-link" href="/pages/search-books.html">Search Books</a>
                    </li>
                    
                    <!--THESE FEATURES ONLY WILL BE VISIBLE AFTER LOGIN with extra remark class="nav-item auth-required"-->
                    
                    <!-- List a Book -->
                    <li class="nav-item auth-required" style="display: none;">
                        <a class="nav-link" href="/pages/list-book.html">List a Book</a>
                    </li>
                    
                    <!-- My Received Requests -->
                    <li class="nav-item auth-required" style="display: none;">
                        <a class="nav-link" href="/pages/my-received-requests.html">My Received Requests</a>
                    </li>
                    
                    <!-- My Sent Requests -->
                    <li class="nav-item auth-required" style="display: none;">
                        <a class="nav-link" href="/pages/my-sent-requests.html">My Sent Requests</a>
                    </li>
                    
                    <!-- Chat -->
                    <li class="nav-item auth-required" style="display: none;">
                        <a class="nav-link" href="/pages/chat.html">Chat</a>
                    </li>
                    
                    <!-- Swap History -->
                    <li class="nav-item auth-required" style="display: none;">
                        <a class="nav-link" href="/pages/swap-history.html">Swap History</a>
                    </li>
                </ul>
                
                <!-- RIGHT SIDE USER MENU(Authentication buttons)-->
                <div class="d-flex">
                    
                    <!-- BEFORE LOGIN WILL SHOW AS -->
                    <div id="auth-buttons" class="auth-buttons">
                        <a href="/pages/login.html" class="btn btn-outline-primary me-2">Login</a>
                        <a href="/pages/register.html" class="btn btn-primary">Sign Up</a>
                    </div>
                    
                    <!-- AFTER LOGIN WILL SHOW AS -->
                    <div id="user-menu" class="auth-required dropdown" style="display: none;">
                        <button class="btn btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                            <span id="user-name">User</span>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="/pages/profile.html">ðŸ‘¤ My Profile</a></li>
                            <li><a class="dropdown-item" href="/pages/my-books.html">ðŸ“š My Books</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="/logout">ðŸšª Logout</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Success/Error Messages -->
    <div class="container mt-3">
        <div id="flash-messages"></div>
    </div>

    <!-- Static Banner -->
    <div class="banner-container position-relative text-center">
        <a href="/pages/search-books.html">
            <img src="/images/book-swap.jpg" class="img-fluid w-100" alt="BookBuddy Banner">
        </a>
    </div>

    <!-- About BookBuddy Section -->
    <section class="container my-5">
        <h2 class="text-center mb-4">About BookBuddy</h2>
        <p class="lead mb-3">
            BookBuddy is a location-based web platform designed to help users exchange books with others nearby. Unlike traditional book-swapping platforms that might rely on global shipping, BookBuddy focuses on local, person-to-person swaps, making book swapping easier, faster, and more community-oriented. This platform allows users to list books they no longer need, search for books nearby, and arrange swaps with others through a secure and user-friendly interface. Whether it's a novel, a textbook, or a hidden gem, BookBuddy makes it simple to give books a second life.
        </p>
        <p class="lead">
            The target users of the app are local communities, university and campus communities, or book lovers who are interested in discovering new titles through nearby, person-to-person exchanges. BookBuddy's aim is to encourage local sharing, cut down on waste, and make finding books more affordable and social.
        </p>
    </section>

    <!-- How It Works Section -->
    <section class="container my-5">
        <h2 class="text-center mb-4">How BookBuddy Works</h2>
        <div class="row row-cols-1 row-cols-md-2 g-4">
        
        <div class="col">
            <div class="card h-100 border-0">
            <div class="card-body">
                <h5 class="card-title">1. Sign Up and Create Your Profile</h5>
                <p class="card-text">Register easily with your email and set up your profile to start sharing and swapping books in your community.</p>
            </div>
            </div>
        </div>
        
        <div class="col">
            <div class="card h-100 border-0">
            <div class="card-body">
                <h5 class="card-title">2. List Books You Want to Swap</h5>
                <p class="card-text">Add books from your collection that you're ready to share. Include details like title, author, genre, and condition â€” plus upload photos to attract other readers.</p>
            </div>
            </div>
        </div>
        
        <div class="col">
            <div class="card h-100 border-0">
            <div class="card-body">
                <h5 class="card-title">3. Find Books Nearby</h5>
                <p class="card-text">Use BookBuddy's location-based search to browse books listed by users near you. Filter by radius, title, author, or genre to find your next great read close to home.</p>
            </div>
            </div>
        </div>
        
        <div class="col">
            <div class="card h-100 border-0">
            <div class="card-body">
                <h5 class="card-title">4. Send and Receive Swap Requests</h5>
                <p class="card-text">When you find a book you want, send a swap request to the owner. Manage incoming and outgoing requests easily through your dashboard.</p>
            </div>
            </div>
        </div>
        
        <div class="col">
            <div class="card h-100 border-0">
            <div class="card-body">
                <h5 class="card-title">5. Chat and Arrange the Swap</h5>
                <p class="card-text">Use the built-in chat system to coordinate pickup details, ask questions, or suggest swaps â€” all securely within the app.</p>
            </div>
            </div>
        </div>
        
        <div class="col">
            <div class="card h-100 border-0">
            <div class="card-body">
                <h5 class="card-title">6. Complete the Swap and Enjoy Your Book</h5>
                <p class="card-text">Meet locally, exchange books, and dive into your new read! Track your swap history anytime and build connections with fellow book lovers.</p>
            </div>
            </div>
        </div>
        
        </div>
    </section>

    <!-- Footer -->
    <section class="bg-light text-dark">
        <div class="container mt-3">
          <div class="row g-4 justify-content-center">
            
            <!-- Follow us centered in full width -->
            <div class="col-12 text-center mb-5">
              <h5 class="category-heading">Follow us</h5>
              <div class="d-flex justify-content-center gap-4">
                <a href="https://www.facebook.com/NCIRL/" class="fuIcon">
                  <img src="/images/icons8-facebook-128.png" alt="facebook icon">
                </a>
                <a href="https://www.instagram.com/ncirl/" class="fuIcon">
                  <img src="/images/icons8-instagram-160.png" alt="instagram icon">
                </a>
                <a href="https://x.com/NCIRL" class="fuIcon">
                  <img src="/images/icons8-twitterx-144.png" alt="twitter icon">
                </a>
              </div>
            </div>
      
          </div>
          <div class="col-12 mt-2 pb-2 text-center text-light">
            &copy; 2025, BookBuddy
          </div>
        </div>
    </section>
    
    <!-- Bootstrap Script -->	
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    
    <!-- Authentication and Navigation Script -->
    <script>
        // Check authentication status and update navbar
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthenticationStatus();
            displayFlashMessages();
        });

        //  Checks if user is log in using an API end point
        async function checkAuthenticationStatus() {
            try {
                const response = await fetch('/api/current-user'); // call API endpoint on the server
                if (response.ok) {
                    const user = await response.json(); // the endpoint return in json
                    if (user && user.authenticated) { // if user is logged in 
                        showAuthenticatedNavbar(user); // run this method 
                    } else {
                        showPublicNavbar(); //run this only show public navbar
                    }
                } else {
                    showPublicNavbar();
                }
            } catch (error) {
                console.error('Error checking authentication:', error);
                showPublicNavbar();
            }
        }

        // after logged in view navbar & right side user info menu 
        function showAuthenticatedNavbar(user) {
            // Hide login/signup buttons
            document.getElementById('auth-buttons').style.display = 'none';
            
            // Show authenticated features
            const authRequired = document.querySelectorAll('.auth-required');
            authRequired.forEach(element => {
                element.style.display = 'block';
            });
            
            // Update user name in dropdown
            document.getElementById('user-name').textContent = user.firstName || 'User';
        }

        // Shows login/sign up buttons if not log in.
        function showPublicNavbar() {
            // Show login/signup buttons
            document.getElementById('auth-buttons').style.display = 'flex';
            
            // Hide authenticated features
            const authRequired = document.querySelectorAll('.auth-required');
            authRequired.forEach(element => {
                element.style.display = 'none';
            });
        }

        // shows success/error URL messages 
        function displayFlashMessages() {
            const urlParams = new URLSearchParams(window.location.search);
            const flashContainer = document.getElementById('flash-messages');
            
            if (urlParams.get('success')) {
                showFlashMessage('success', decodeURIComponent(urlParams.get('success')));
            }
            if (urlParams.get('error')) {
                showFlashMessage('danger', decodeURIComponent(urlParams.get('error')));
            }
        }

        // Creates a message box for showing the messages
        function showFlashMessage(type, message) {
            const flashContainer = document.getElementById('flash-messages');
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            flashContainer.appendChild(alertDiv);
            
            // Auto-hide after 5 seconds
            setTimeout(() => {
                alertDiv.remove();
            }, 5000);
        }
    </script>
    </body>
</html>